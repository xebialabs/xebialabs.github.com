<html><head><LINK REL=StyleSheet HREF="css/deployit.css" TYPE="text/css" MEDIA=screen>
<LINK REL=StyleSheet HREF="css/ci-reference-api.css" TYPE="text/css" MEDIA=screen>
<script type="text/javascript" src="js/jquery-1.6.2.min.js"></script>
<script type="text/javascript" src="js/jquery.tableofcontents.min.js"></script>
<script type="text/javascript" charset="utf-8">
$(document).ready(function(){
    document.body.id = "top-toc";
    var title = $("<div class='manual-title'/>")
    title.html("<div class='title'>System Administration Manual</div><div class='version'>Version <span class='version-number'>3.6.0</span></div>");
    $("body").css('width', '100%');
    $("body").prepend(title);
    $("body").prepend($("<ol id='toc'/>"));
    $("#toc").tableOfContents("body", { topLinks: true, } );
});

</script>
<title>System Administration Manual</title>
</head><body><h1>Preface</h1><p>This manual describes how to install and setup Deployit.</p><h1>Installing Deployit</h1><p>This section contains information on the installation of the Deployit server.</p><h2>Prerequisites</h2><h3>Server Requirements</h3><p>To install the Deployit server, the following prerequisites must be met:</p>
<ul>
  <li><strong>Operating system</strong>: Windows or Unix-family operating system running Java.</li>
  <li><strong>Java Runtime Environment</strong>: JDK 1.6 (Oracle, IBM or Apple)</li>
  <li><strong>RAM</strong>: At least 2GB of RAM available for Deployit.</li>
  <li><strong>Harddisk space</strong>: Sufficient harddisk space to store the Deployit repository. This depends on your usage of Deployit. See section <strong>Determining Harddisk Space Requirements</strong>.</li>
</ul><p>Depending on the environment, the following may also be required:</p>
<ul>
  <li><strong>Database</strong>: Deployit's Jackrabbit repository supports a number of different databases. For more information see section <strong>Configuring the Repository</strong>.</li>
  <li><strong>LDAP</strong>: To enable group-based security, an LDAP x.509 compliant registry is needed. For more information see section <strong>Configuring LDAP Security</strong>.</li>
</ul><h3>Determining Harddisk Space Requirements</h3><p>The Deployit server itself only uses about 70MB of disk space. The main harddisk space usage comes from the repository which stores your deployment packages and deployment history. The size of the repository will vary from installation to installation but depends mainly on:</p>
<ul>
  <li>the size and storage mechanism used for artifacts</li>
  <li>the number of packages in the system</li>
  <li>the number of deployments performed (more specifically, the amount of logging information stored)</li>
</ul><p>Follow this procedure to obtain an estimate of the total required disk space:</p>
<ul>
  <li>Install and configure Deployit for your environment as described in this document. Make sure you correctly set up the database- or file-based repository.</li>
  <li>Estimate the number of packages to be imported (either the total number or the number per unit of time) (<code>NumPackages</code>)</li>
  <li>Estimate the number of deployments to be performed (either the total number or the number per unit of time) (<code>NumDeployments</code>)</li>
  <li>Record the amount of disk space used by Deployit (<code>InitialSize</code>).</li>
  <li>Import a few packages using the GUI or CLI.</li>
  <li>Record the amount of disk space used by Deployit (<code>SizeAfterImport</code>).</li>
  <li>Perform a few deployments.</li>
  <li>Record the amount of disk space used by Deployit (<code>SizeAfterDeployments</code>).</li>
</ul><p>The needed amount of disk space in total is equal to:</p>
<pre><code>Space Needed = ((SizeAfterImport - InitialSize) * NumPackages) +
    ((SizeAfterDeployments - SizeAfterImport) * NumDeployments)
</code></pre><p>If <code>NumPackages</code> and <code>NumDeployments</code> are expressed per timeunit (e.g. the number of packages to be imported per month), then the end result represents the space needed per month as well.</p><h3>Unix Middleware Server Requirements</h3><p>Unix-based middleware servers that Deployit interacts with must meet the following requirements:</p>
<ul>
  <li><strong>SSH Access</strong>: The target systems should be accessible by SSH from the Deployit server, i.e. they should run an SSH2 server. It is also possible to handle key-based authorization. Notes:</li>
  <li>The SSH daemon on AIX is known to hang with certain types of SSH traffic.</li>
  <li>For security, the SSH account that is used to access a host should have limited rights.</li>
  <li>A variety of Linux distributions have made SSH require a TTY by default. This setting is incompatible with Deployit and is controlled by the <code>Defaults requiretty</code> setting in the <code>sudoers</code> file.</li>
  <li><p><strong>Credentials</strong>: Deployit should be able to log in to the target systems using a login/password combination that allows it to perform at least the following Unix commands:</p>
  <ul>
    <li><code>cp</code></li>
    <li><code>ls</code></li>
    <li><code>mv</code></li>
    <li><code>rm</code></li>
    <li><code>mkdir</code></li>
    <li><code>rmdir</code></li>
  </ul><p>If the login user cannot perform these actions, Deployit can also use a <code>sudo</code> user that can execute these commands.</p></li>
</ul><h3>Windows Middleware Server Requirements</h3><p>Windows-based middleware servers that Deployit interacts with must meet the following requirements:</p>
<ul>
  <li><strong>File system access</strong>: The target file system should be accessible via CIFS from the Deployit server.</li>
  <li><strong>Host access</strong>: The target host should be accessible from the Deployit server via WinRM or Windows Telnet server running in <em>stream mode</em>.</li>
  <li><strong>Directory shares</strong>: The account used to access a target system should have access to the host's administrative shares such as <strong>C$</strong>.</li>
  <li><strong>Ports</strong>: For CIFS connectivity, port 445 on the target system should be accessible from the Deployit server. For Telnet connectivity, port 23 should be accessible from the Deployit server. For WinRM connectivity, port 5985 (HTTP) or port 5986 (HTTPS) should be accessible from the Deployit server.</li>
</ul><h3>Extending Middleware Support</h3><p>It is possible to connect Deployit to middleware servers that do not support SSH, Telnet or WinRM. Using the Overthere remote execution framework, a custom <em>access method</em> can be created that connects to the server. See the <strong>Customization Manual</strong> for more details.</p><h3>Client Requirements</h3><h4>GUI Clients</h4><p>To use the Deployit GUI, you must meet the following requirements:</p>
<ul>
  <li><strong>Web browser</strong>: The following web browsers are supported:
  <ul>
    <li>IE 7.0 or up</li>
    <li>Firefox 3.0 or up</li>
    <li>Safari 3.0 or up</li>
  </ul></li>
  <li><strong>Flash Player</strong>: A flash player is required, versions 9.0 and up are supported.</li>
</ul><h4>CLI Clients</h4><p>To use the Deployit CLI, you must meet the following requirements:</p>
<ul>
  <li><strong>Operating system</strong>: Windows or Unix-family operating system running Java.</li>
  <li><strong>Java Runtime Environment</strong>: JDK 1.6 (Oracle, IBM or Apple)</li>
</ul><h2>Installation Procedure</h2><p>To begin installing Deployit, first unpack the distribution archive. The distribution archive contains the following:</p>
<ul>
  <li>Release notes describing the changes made in this version of Deployit.</li>
  <li>A server archive.</li>
  <li>A CLI archive.</li>
</ul><h3>Installing the Server</h3><p>Follow these steps to install the Deployit server application:</p>
<ol>
  <li><strong>Login to the server where the Deployit Server will be installed</strong>. It is recommended to install Deployit Server as a non-root user, e.g. <code>deployit</code>.</li>
  <li><strong>Create an installation directory</strong>, e.g. <code>/opt/xebialabs/deployit</code>.</li>
  <li><strong>Copy the Deployit Server archive to the directory</strong>.</li>
  <li><strong>Extract the archive into the directory</strong>.</li>
</ol><p><strong>Deployit Server Directory Structure</strong></p><p>Once the Deployit installation file is extracted, the following directory structure exists in the installation directory (in the remainder of the document this directory will be referred to as <em>DEPLOYIT_SERVER_HOME</em>):</p>
<ul>
  <li><strong>bin</strong>: contains the Server binaries</li>
  <li><strong>conf</strong>: contains Server configuration files (this directory is only present once you have configured Deployit Server)</li>
  <li><strong>doc</strong>: contains the Deployit product documentation</li>
  <li><strong>ext</strong>: contains Server Java extensions. See the <strong>Customization Manual</strong> for more information.</li>
  <li><strong>hotfix</strong>: contains hotfixes that fix issues with the Server software</li>
  <li><strong>importablePackages</strong>: default location for importable packages</li>
  <li><strong>lib</strong>: contains libraries that Server needs</li>
  <li><strong>log</strong>: contains Server log files (this directory is only present once you have started Deployit Server)</li>
  <li><strong>plugins</strong>: contains the Deployit middleware plugins</li>
  <li><strong>recovery.dat</strong>: stores tasks that are in progress for recovery purposes (this file is only present once you have started Deployit Server)</li>
</ul><h3>Installing the CLI</h3><p>Follow these steps to install the Deployit CLI application:</p>
<ol>
  <li><strong>Login to the server where the Deployit CLI will be installed</strong>.</li>
  <li><strong>Create an installation directory</strong>.</li>
  <li><strong>Copy the Deployit CLI archive to the directory</strong>.</li>
  <li><strong>Extract the archive into the directory</strong>.</li>
</ol><p><strong>Deployit CLI Directory Structure</strong></p><p>Once the Deployit installation file is extracted, the following directory structure exists in the installation directory:</p>
<ul>
  <li><strong>bin</strong>: contains the CLI binaries</li>
  <li><strong>ext</strong>: contains CLI Python extension scripts</li>
  <li><strong>hotfix</strong>: contains hotfixes that fix issues with the CLI software</li>
  <li><strong>lib</strong>: contains necessary libraries</li>
  <li><strong>plugins</strong>: contains the CLI plugins</li>
</ul><h3>Running the Server Setup Wizard</h3><p>Run the Deployit Setup Wizard to start the Deployit server and prepare it for use. The command <code>server.sh -setup</code> starts the wizard. If you want to stop the Setup Wizard at any time, enter <code>exitsetup</code>. All changes to the configuration will be discarded.</p><p>The Setup Wizard displays the following welcome message:</p>
<pre><code>Welcome to the Deployit setup.
You can always exit by typing &#39;exitsetup&#39;.
To re-run this setup and make changes to the Deployit server configuration 
you can run server.cmd -setup on Windows or server.sh -setup on Unix.

Do you want to use the simple setup?
Default values are used for all properties. To make changes to the default 
properties, please answer no.
Options are yes or no.
[yes]: 
</code></pre><p>Answer <strong>yes</strong> (or press Enter) to use the simple setup. Simple setup makes it easy to quickly get started with Deployit and to use the product's default configuration. See <strong>Simple Setup</strong> for more information.</p><p>Answer <strong>no</strong> to use the manual setup. Manual setup provides explicit control over all Deployit settings. See <strong>Manual Setup</strong> for more information.</p><p><strong>Note</strong>: if you installed Deployit in the same location before, the Setup Wizard will ask you whether you want to edit the existing configuration or create a new one. Answer <strong>yes</strong> (or press Enter) to edit the existing configuration. The Setup Wizard will load all settings from the existing configuration and allow you to choose simple or manual setup. Answer <strong>no</strong> to start over with an empty configuration.</p><h4>Simple Setup</h4><p>Using simple setup, the Setup Wizard will assume default values for all configuration parameters. Specifically, the following defaults will be used:</p>
<ul>
  <li>The server will run with security enabled.</li>
  <li>The server will <strong>not</strong> use secure communication between the Deployit GUI and the Deployit server.</li>
  <li>The server will listen on Deployit's standard HTTP port (4516).</li>
  <li>The server will use a minimum of 3 and a maximum of 24 threads.</li>
  <li>Applications can be imported from the <code>importablePackages</code> directory.</li>
</ul><p>The Setup Wizard will ask one more question:</p>
<pre><code>Do you want Deployit to initialize the JCR repository?
Options are yes or no.
[yes]: 
</code></pre><p>Answer <strong>yes</strong> (or press Enter) if you want the Deployit repository to be recreated. The Setup Wizard must have write access to the repository directory. Answer <strong>no</strong> to leave the repository intact. This option is useful if you already have an existing repository that you want to reuse. </p><p>See <strong>Finishing the Setup Wizard</strong> for completing the setup process.</p><p><strong>Warning</strong>: if you choose to recreate the Deployit repository and you have installed Deployit in the same location before, any information stored in the repository will be lost.</p><h4>Manual Setup</h4><p>The manual setup procedure contains the following steps:</p><p><strong>Secure Communication Configuration</strong></p><p>The Setup Wizard will show the following message:</p>
<pre><code>Would you like to enable SSL?
Options are yes or no.
[yes]: 
</code></pre><p>Answer <strong>no</strong> to use regular unsecured communication between the GUI and the server. Continue with the <strong>port configuration</strong> section. </p><p>Answer <strong>yes</strong> (or press Enter) if you want to use a secure connection from the GUI to the server.</p><p>If you answer <strong>yes</strong>, the Setup Wizard will ask the following question to help you configure secure communication:</p>
<pre><code>Would you like Deployit to generate a keystore with a self-signed 
certificate for you?
N.B.: Self-signed certificates do not work correctly with some versions 
of the Flash Player and some browsers!
Options are yes or no.
[yes]: 
</code></pre><p>Answer <strong>yes</strong> (or press Enter) if you want the Setup Wizard to generate a digital certificate automatically. The digital certificate is required to secure communication and is normally signed by a Certificate Authority (CA). The Setup Wizard can generate a <em>self-signed</em> certificate if there is no official certificate available. Beware that using a self-signed certificate may trigger security warnings in some Flash players and browsers. Continue with the <strong>port configuration</strong> section.</p><p>Answer <strong>no</strong> if you want to use your own keystore. Deployit uses the built-in Jetty webserver to communicate with the GUI. Jetty requires a certificate with the name <code>Jetty</code> to be present in the keystore.</p><p>The Setup Wizard prompts you for the following keystore information:</p>
<pre><code>What is the path to the keystore?
[]: 

What is the password to the keystore?
[]: 

What is the password to the key in the keystore?
[]: 
</code></pre><p>Enter the filesystem location of the keystore (for example, <em>mykeystore.jks</em>), the password to unlock the keystore and the password for the <code>Jetty</code> certificate in the keystore. </p><p><strong>Port Configuration</strong></p><p>The Setup Wizard shows the following question:</p>
<pre><code>What http port number would you like the server to listen on?
[4516]: 
</code></pre><p><strong>Note</strong>: if you chose to enable secure communication, the default port will be <em>4517</em> instead of <em>4516</em>.</p><p>Enter the port number that the Deployit server listens on for connections.</p><p><strong>Thread Configuration</strong></p><p>The Setup Wizard shows the following questions:</p>
<pre><code>Enter the minimum number of threads the HTTP server should use (recommended: 
    3 per client, so 3 for single user usage)
[3]: 
</code></pre><p>Enter the minimum number of threads that the Deployit server uses to handle incoming connections. The recommended minimum number of threads is 3 per Deployit application client.</p>
<pre><code>Enter the maximum number of threads the HTTP server should use (recommended :
    3 per client, so 24 for 8 concurrent users)
[24]: 
</code></pre><p>Enter the maximum number of threads that the Deployit server uses to handle incoming connections. The recommended maximum number of threads is 3 per Deployit application client.</p><p><strong>Repository Configuration</strong></p><p>The Setup Wizard shows the following questions:</p>
<pre><code>Where would you like Deployit to store the JCR repository?
[repository]: 
</code></pre><p>Enter the filesystem path to a directory where Deployit will create the repository. If the directory does not exist, the Setup Wizard will create it.</p>
<pre><code>Do you want Deployit to initialize the JCR repository?
Options are yes or no.
[yes]: 
</code></pre><p>Answer <strong>yes</strong> (or press Enter) if you want the Deployit repository to be recreated. The Setup Wizard must have write access to the repository directory.</p><p>Answer <strong>no</strong> to leave the repository intact.</p><p><strong>Warning</strong>: if you choose to recreate the Deployit repository and you have installed Deployit in the same location before, any information stored in the repository will be lost.</p><p><strong>Importable Packages Configuration</strong></p><p>The Setup Wizard shows the following question:</p>
<pre><code>Where would you like Deployit to import packages from?
[importablePackages]: 
</code></pre><p>Enter the filesystem path to a directory from which Deployit will import packages. The Setup Wizard assumes that this directory exists once the Deployit server starts and will not create it.</p><h4>Finishing the Setup Process</h4><p>Once you have completed configuration of the setup process, the Setup Wizard displays an overview of all selected options. The following text is an example:</p>
<pre><code>Do you agree with the following settings for Deployit and would you like 
    to save them?
Changes will be saved in deployit.conf
    SSL will be disabled
    HTTP port is 4516
    HTTP server will use a minimum of 3 and a maximum of 24 threads
    JCR repository home is at repository
    JCR repository will be initialized.
    Task recovery file will deleted
    Application import location is importablePackages
[yes]:         
</code></pre><p>Answer <strong>yes</strong> (or press Enter) to store the configuration settings and end the Setup Wizard. If you selected the option to initialize the repository, this will be done now.</p><p>Answer <strong>no</strong> to abort the Setup Wizard.</p><p>If the Setup Wizard is successfully completed, it will display the following message:</p>
<pre><code>You can now start your Deployit server by executing the command server.cmd 
    on Windows or server.sh on Unix.
Note: If your Deployit server is running please restart it.
Finished setup.
</code></pre><h3>Changing the Admin Password</h3><p>By default, Deployit is installed with a special user with administrative permissions. This user has the username <code>admin</code> and password <code>admin</code>. As the last step in the installation, the admin password should be changed to something more secure. Issue the following commands in the CLI to do this:</p>
<pre><code>adminUser = security.readUser(&#39;admin&#39;)
adminUser.password = &#39;newpassword&#39;
security.modifyUser(adminUser)

# Test whether the change is successful
security.logout()
security.login(&#39;admin&#39;, &#39;newpassword&#39;)
</code></pre><h2>High Availability Setup</h2><p>Deployit can be configured to ensure maximum uptime of the application. In such a high availability setup, two instances of Deployit are running in an <em>active/passive</em> configuration. At any one time, only one Deployit instance is active but as soon as a failure is detected, the passive Deployit instance is activated and the failed instance is taken down for repair. </p><p>The easiest way to achieve such a configuration is by using the same configuration for each Deployit instance.</p><p><strong>Warning</strong>: unpredictable results may occur when running two Deployit instances against the same repository <em>at the same time</em>. </p><p>When switching from one Deployit instance to another, any running tasks will be recovered by the new instance (see the <strong>Deployit Reference Manual</strong> for more information). </p><p>To configure such a setup, a router with <em>active/passive</em> support must be used.</p><h1>Upgrading Deployit</h1><p>To begin upgrading Deployit, first unpack the distribution archive. The distribution archive contains the following:</p>
<ul>
  <li>Release notes describing the changes made in this version of Deployit.</li>
  <li>A server archive.</li>
  <li>A CLI archive.</li>
</ul><h2>Upgrading the Server</h2><p>To upgrade an existing Deployit server installation, do the following:</p>
<ol>
  <li>Create a directory for the new Deployit server installation, including the new Deployit server version number in the directory name.</li>
  <li>Extract the server archive in this directory.</li>
  <li>Copy the contents of the <strong>conf</strong>, <strong>repository</strong> and <strong>hotfix</strong> directories from the previous installation into the new installation directory.</li>
  <li>Copy the contents of the <strong>importablePackages</strong> directory from the previous installation into the new installation directory.</li>
  <li>Copy the contents of the <strong>plugins</strong> directory from the previous installation into the new installation directory.</li>
  <li>Copy the contents of the <strong>ext</strong> directory from the previous installation into the new installation directory.</li>
  <li>If you have made any changes to the Deployit server startup scripts (<em>server.sh</em> or <em>server.cmd</em>), copy these from the <strong>bin</strong> directory in the previous installation into the new installation directory.</li>
</ol><p><strong>Note</strong>: please make sure that the plugins and extensions in the old Deployit installation are compatible with the new Deployit server version.</p><p>This completes upgrading of the Deployit server.</p><h2>Upgrading the CLI</h2><p>To upgrade an existing Deployit CLI installation, do the following:</p>
<ol>
  <li>Create a directory for the new Deployit CLI installation, including the new Deployit CLI version number in the directory name.</li>
  <li>Extract the CLI archive in this directory.</li>
  <li>Copy the contents of the <strong>plugins</strong>, <strong>ext</strong> and <strong>hotfix</strong> directories from the previous installation into the new installation directory.</li>
  <li>If you have made any changes to the Deployit CLI startup scripts (<em>cli.sh</em> or <em>cli.cmd</em>), copy these from the <strong>bin</strong> directory in the previous installation into the new installation directory.</li>
</ol><p>This completes upgrading of the Deployit CLI.</p><h1>Configuring Deployit</h1><p>This section contains information on the configuration of the Deployit server.</p><h2>Configuring Security</h2><h3>Security in Deployit</h3><p>Deployit supports a fine-grained access control scheme to ensure the security of your middleware and deployments. Deployit's security mechanism is based on the concepts of <em>principals</em> and <em>permissions</em>.</p><p><strong>Principals</strong></p><p>A (security) principal is an entity that can be authenticated and that can be assigned rights over resources in Deployit. Out of the box, Deployit supports only users as principals -- users are authenticated by means of a username and password and rights within Deployit are assigned to the user itself. When using an LDAP repository, groups in LDAP are also treated as principals. See below for more information about LDAP.</p><p>There is one special user, <code>admin</code>, who has special rights in Deployit. This user is allowed to grant and revoke security permissions.</p><p><strong>Permissions</strong></p><p>Permissions are rights to execute particular actions in Deployit. Some permissions also imply the rights to make modifications to (certain parts of) the repository. Permissions can also be restricted to a subset of the resources in Deployit if fine-grained access control is required. See the <strong>Reference Manual</strong> for more information about the repository structure.</p><p>Deployit supports the following permissions:</p>
<ul>
  <li><strong>read</strong>. The right to see particular CIs.</li>
  <li><strong>login</strong>. The right to log into the Deployit application. This permission does not allow the user has to access nodes in the repository.</li>
  <li><strong>import#initial</strong>. The right to import a package for which the application does not yet exist in the repository and for which a new application will be created. This implies read and write access to the <strong>Applications</strong> node. The permission can also be given for specific <em>Application</em> CIs.</li>
  <li><strong>import#upgrade</strong>. The right to import a package for which the application already exists in the repository. This implies read and write access to the <strong>Applications</strong> node. The permission can also be given for specific <em>Application</em> CIs.</li>
  <li><strong>deploy#initial</strong>. The right to perform an initial deployment of a package to an environment. This implies read and write access to the <strong>Environments</strong> and <strong>Infrastructure</strong> nodes. The permission can also be given for specific <em>Environment</em> CIs.</li>
  <li><strong>deploy#upgrade</strong>. The right to perform an upgrade of a deployment on an environment. Note that this does <em>not</em> allow deploying items from your package to new targets. This implies read and write access to the <strong>Environments</strong> and <strong>Infrastructure</strong> nodes. The permission can also be given for specific <em>Environment</em> CIs.</li>
  <li><strong>discovery</strong>. The right to perform discovery. This implies read and write access to the <strong>Infrastructure</strong> node.</li>
  <li><strong>repo#edit</strong>. The right to edit (create and modify) CIs in the repository. This implies write access to the <strong>Applications</strong>, <strong>Environments</strong> and <strong>Infrastructure</strong> nodes. The user must also have read access to CIs to be able to edit them. The permission can also be given for specific CIs.</li>
  <li><strong>deploy#undeploy</strong>. The right to undeploy an application. This implies read and write access to the <strong>Environments</strong> and <strong>Infrastructure</strong> nodes. The permission can also be given for specific <em>Environment</em> CIs.</li>
  <li><strong>task#skip_step</strong>. The right to skip steps in the generated steplist before starting a deployment.</li>
  <li><strong>task#move_step</strong>. The right to move steps in the generated steplist before starting a deployment.</li>
  <li><strong>controltask#execute</strong>. The right to execute control tasks on configuration items.</li>
</ul><h3>Granting, Revoking and Denying</h3><p>Access rights in Deployit can be <em>granted</em> to a principal or <em>revoked</em> from a principal. When rights are granted, the principal is allowed to perform some action or access repository entities. Rights once granted can be revoked again to prevent the action in the future. Rights can also be explicitly <em>denied</em>. Denying permission acts as a negative grant -- the right is explicitly disallowed.</p><p>Access rights can be used stand-alone or in combination with one or more CIs. In the former case, the principal will have access to <strong>all</strong> CIs associated with the permission. In the latter case, the access rights will be restricted to the particular CIs. For example, granting <em>import#initial</em> to a principal allows the principal to import any application. Granting <em>import#initial</em> on <em>Applications/PetClinic</em> allows the principal to import only <em>PetClinic</em> packages.</p><h3>Configuring Repository Security</h3><p>Security in the Deployit repository can be configured using the command line interface. See the <strong>Deployit Command Line Interface (CLI) Manual</strong> for more information.</p><p><strong>Creating Users</strong></p><p>Deployit can only create users in it's own repository, even if it is configured to use an LDAP repository for authentication and authorization. To do this, use a statement such as the following:</p>
<pre><code>deployer = security.createUser(&quot;john&quot;, &quot;secret&quot;)
</code></pre><p><strong>Granting Permissions</strong></p><p>To grant a particular permission to a principal, use a statement such as the following:</p>
<pre><code>security.grant(&quot;import#initial&quot;, &quot;john&quot;)
</code></pre><p>To grant a particular permission to a principal on a CI, use a statement such as the following:</p>
<pre><code>security.grant(&quot;read&quot;, &quot;mary&quot;, [&#39;Environments/Dev&#39;])
</code></pre><p><strong>Revoking Permissions and Privileges</strong></p><p>To revoke a particular permission from a principal, use a statement such as the following:</p>
<pre><code>security.revoke(&quot;read&quot;, &quot;john&quot;, [&#39;Environments/Dev&#39;])
</code></pre><h3>Inherited Permissions</h3><p>Permissions in Deployit are <em>inherited</em> for all CIs that are contained in the CI node you specified the permissions for. For example, if you have read permission on <em>Environments/Dev</em>, you will also have read permission on all of the CIs under this node such as deployed applications. This is what happens when you use stand-alone permissions. If you use permissions on specific CIs, these permissions are set only on the specified CIs and are inherited from this CI onwards.</p><h3>Permissions on Deployed Applications</h3><p>Giving users permissions on deployed applications requires some knowledge of how these CIs are stored in the repository. As described in the <strong>Deployit Reference Manual</strong>, deployed applications are stored under both the <strong>/Environments</strong> as well as <strong>/Infrastructure</strong> nodes. Giving users read permission on a deployed application involves giving them permissions under both nodes.</p><h3>Security Configuration Example</h3><p>Let's illustrate the security setup with an example.</p><p>In a typical medium to large size company, there several different groups of people that perform tasks related to deployments. There are administrators that install, test and maintain hardware, there are deployers that deploy applications to development, test, acceptance and production environments. And finally there are the developers who build these applications.</p><p>Translating this into Deployit terms:</p>
<ul>
  <li><strong>administrators</strong>: permission to create, update and delete infrastructure as well as permission to create, update and delete environments. (all handled by <em>repo#edit</em> permission)</li>
  <li><strong>deployers</strong>: permission to import new applications (<em>import#initial</em>), deploy to DEV, TEST and view PROD (<em>deploy#initial</em> and <em>deploy#upgrade</em> on environments DEV and TEST, <em>read</em> rights on environment PROD).</li>
  <li><strong>senior deployers</strong>: permission to import new applications (<em>import#initial</em>), deploy to DEV, TEST and PROD (<em>deploy#initial</em> and <em>deploy#upgrade</em> on environments DEV, TEST and PROD).</li>
  <li><strong>developers</strong>: permission to import new versions of existing applications (<em>import#upgrade</em>) and to upgrade existing deployments (<em>deploy#upgrade</em>).</li>
</ul><p>See the <strong>Deployit Command Line Interface (CLI) Manual</strong> for the exact commands to implement this.</p><h3>Configuring LDAP Security</h3><p>By default, Deployit authenticates users and retrieves authorization information from it's repository. Deployit can also be configured to use an LDAP repository to authenticate users and to retrieve role (group) membership. In this scenario, the LDAP users and groups are used as principals in Deployit. Rights can be assigned to both users and groups. The rights assigned to a principal are always stored in the JCR repository. </p><p>Deployit treats the LDAP repository as <strong>read-only</strong>. This means that Deployit will use the information from the LDAP repository, but can not make changes to that information. </p><p>When authenticating a user, Deployit first tries to locate the user in the LDAP repository. If this fails, Deployit will check it's own repository as a backup.</p><p>To configure Deployit to use an LDAP repository, the built-in JCR repository, Jackrabbit, must defer to the LDAP server for authentication. This requires modification of the default Deployit Jackrabbit configuration. Follow these steps:</p>
<ol>
  <li><p><strong>Edit <code>conf/jackrabbit-jaas.config</code> file</strong>.</p><p>The file must be accessible for the Deployit server. The sample file can be adapted to suit your needs. The LdapLoginModule takes the following arguments:</p>
  <ul>
    <li><strong>userProvider</strong>: The LDAP url to connect to, including the bind path (example: userProvider="ldap://localhost:389/ou=system")</li>
    <li><strong>userFilter</strong>: The LDAP filter to determine the LDAP dn for the user that's logging in, {USERNAME} will be replaced with the username that's logging in (example: userFilter="(&amp;(uid={USERNAME})(objectClass=inetOrgPerson))")</li>
    <li><strong>useSSL</strong>: Whether or not we need to use SSL to connect to LDAP (example: useSSL=false)</li>
    <li><strong>groupFilter</strong>: The LDAP filter to determine the group memberships for the user, {DN} will be replaced with the DN of the user (example: groupFilter="(member={DN})")</li>
    <li><strong>principalProvider</strong>: The LDAP PrincipalProvider that will provide principals to Jackrabbit (example: principalProvider=com.xebialabs.deployit.security.LdapPrincipalProvider)</li>
    <li><strong>java.naming.security.authentication</strong>: The security scheme to use to connect to LDAP (example: java.naming.security.authentication=simple)</li>
    <li><strong>java.naming.security.principal</strong>: The DN of the user that you need to do the initial connect to search LDAP (example: java.naming.security.principal="cn=administrator,ou=users,ou=system")</li>
    <li><strong>java.naming.security.credentials</strong>: The password matching the DN needed to connect to LDAP (example java.naming.security.credentials=secret)</li>
  </ul></li>
  <li><p><strong>Modify the Deployit server startup command</strong>. </p><p>Notify the Deployit server of the new configuration file by specifying the following JVM variable in the startup script:</p>
  <pre><code>-Djava.security.auth.login.config=&quot;$DEPLOYIT_SERVER_HOME/conf/jackrabbit-jaas.config&quot;
</code></pre></li>
  <li><p><strong>Edit the <code>conf/jackrabbit-repository.xml</code></strong></p><p>Change the jackrabbit-repository.xml by looking up the Security-block, and changing it to look like this:</p>
  <pre><code>&lt;Security appName=&quot;Jackrabbit&quot;&gt;
    &lt;SecurityManager class=&quot;org.apache.jackrabbit.core.DefaultSecurityManager&quot; 
       workspaceName=&quot;security&quot; /&gt;
    &lt;AccessManager class=&quot;org.apache.jackrabbit.core.security.DefaultAccessManager&quot; /&gt;
&lt;/Security&gt;
</code></pre></li>
</ol><h2>Configuring the Repository</h2><h3>Using a Database</h3><p>Deployit can also use a database to store its repository. The built-in Jackrabit JCR implementation must be configured to make this possible. The two relevant components are Jackrabbit's <code>PersistenceManager</code> (used for storing nodes and revisions) and <code>DataStore</code> (optionally used for storing large binary objects). In the default Deployit configuration, the <a href="http://db.apache.org/derby/">Derby database</a> and file system DataStore are used.</p><p>Here are some examples of configuring Deployit to use a database for various database vendors. The XML snippets below must be put into the <code>conf/jackrabbit-repository.xml</code> file.</p><p><strong>Note:</strong> Deployit <strong>must</strong> initialize the repository before it can be used. Run Deployit's setup wizard after making any changes to the Jackrabbit configuration.</p><p>For more information about using a database with Jackrabbit, see it's <a href="http://wiki.apache.org/jackrabbit/PersistenceManagerFAQ">PersistenceManager FAQ</a> and <a href="http://wiki.apache.org/jackrabbit/DataStore">DataStore FAQ</a>.</p><p><strong>Using Deployit with <a href="http://www.mysql.com/">MySQL</a></strong></p>
<pre><code>&lt;Workspace name=&quot;${wsp.name}&quot;&gt;
    &lt;FileSystem class=&quot;org.apache.jackrabbit.core.fs.local.LocalFileSystem&quot;&gt;
       &lt;param name=&quot;path&quot; value=&quot;${wsp.home}&quot; /&gt;
    &lt;/FileSystem&gt;

    &lt;PersistenceManager class=&quot;org.apache.jackrabbit.core.persistence.pool.MySqlPersistenceManager&quot;&gt;
       &lt;param name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/deployit&quot; /&gt;
       &lt;param name=&quot;user&quot; value=&quot;deployit&quot; /&gt;
           &lt;param name=&quot;password&quot; value=&quot;deployit&quot; /&gt;
       &lt;param name=&quot;schemaObjectPrefix&quot; value=&quot;${wsp.name}_&quot; /&gt;
    &lt;/PersistenceManager&gt;

    &lt;SearchIndex class=&quot;org.apache.jackrabbit.core.query.lucene.SearchIndex&quot;&gt;
       &lt;param name=&quot;path&quot; value=&quot;${wsp.home}/index&quot; /&gt;
       &lt;param name=&quot;supportHighlighting&quot; value=&quot;true&quot; /&gt;
    &lt;/SearchIndex&gt;

&lt;/Workspace&gt;

&lt;Versioning rootPath=&quot;${rep.home}/version&quot;&gt;
    &lt;FileSystem class=&quot;org.apache.jackrabbit.core.fs.local.LocalFileSystem&quot;&gt;
       &lt;param name=&quot;path&quot; value=&quot;${rep.home}/version&quot; /&gt;
    &lt;/FileSystem&gt;

    &lt;PersistenceManager class=&quot;org.apache.jackrabbit.core.persistence.pool.MySqlPersistenceManager&quot;&gt;
       &lt;param name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/deployit&quot; /&gt;
       &lt;param name=&quot;user&quot; value=&quot;deployit&quot; /&gt;
         &lt;param name=&quot;password&quot; value=&quot;deployit&quot; /&gt;
       &lt;param name=&quot;schemaObjectPrefix&quot; value=&quot;version_&quot; /&gt;
      &lt;/PersistenceManager&gt;
&lt;/Versioning&gt;
</code></pre><p>Note: The MySQL database is not suited for storage of large binary objects, see <a href="http://bugs.mysql.com/bug.php?id=10859">the MySQL bug tracker</a>.</p><p><strong>Using Deployit with <a href="http://www-01.ibm.com/software/data/db2/">DB2</a></strong></p>
<pre><code>&lt;Workspace name=&quot;${wsp.name}&quot;&gt;
    &lt;FileSystem class=&quot;org.apache.jackrabbit.core.fs.local.LocalFileSystem&quot;&gt;
       &lt;param name=&quot;path&quot; value=&quot;${wsp.home}&quot; /&gt;
    &lt;/FileSystem&gt;

    &lt;PersistenceManager class=&quot;org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager&quot;&gt;
           &lt;param name=&quot;driver&quot; value=&quot;com.ibm.db2.jcc.DB2Driver&quot;/&gt;
           &lt;param name=&quot;url&quot; value=&quot;jdbc:db2://localhost:50002/deployit&quot; /&gt; 
           &lt;param name=&quot;user&quot; value=&quot;deployit&quot; /&gt; 
           &lt;param name=&quot;password&quot; value=&quot;deployit&quot; /&gt;
           &lt;param name=&quot;databaseType&quot; value=&quot;db2&quot; /&gt; 
           &lt;param name=&quot;schemaObjectPrefix&quot; value=&quot;${wsp.name}_&quot; /&gt; 
      &lt;/PersistenceManager&gt;

    &lt;SearchIndex class=&quot;org.apache.jackrabbit.core.query.lucene.SearchIndex&quot;&gt;
       &lt;param name=&quot;path&quot; value=&quot;${wsp.home}/index&quot; /&gt;
       &lt;param name=&quot;supportHighlighting&quot; value=&quot;true&quot; /&gt;
    &lt;/SearchIndex&gt;
&lt;/Workspace&gt;

&lt;Versioning rootPath=&quot;${rep.home}/version&quot;&gt;
    &lt;FileSystem class=&quot;org.apache.jackrabbit.core.fs.local.LocalFileSystem&quot;&gt;
       &lt;param name=&quot;path&quot; value=&quot;${rep.home}/version&quot; /&gt;
    &lt;/FileSystem&gt;

    &lt;PersistenceManager class=&quot;org.apache.jackrabbit.core.persistence.pool.BundleDbPersistenceManager&quot;&gt;
         &lt;param name=&quot;driver&quot; value=&quot;com.ibm.db2.jcc.DB2Driver&quot;/&gt;
         &lt;param name=&quot;url&quot; value=&quot;jdbc:db2://localhost:50002/deployit&quot; /&gt; 
         &lt;param name=&quot;user&quot; value=&quot;deployit&quot; /&gt; 
         &lt;param name=&quot;password&quot; value=&quot;deployit&quot; /&gt;
         &lt;param name=&quot;databaseType&quot; value=&quot;db2&quot; /&gt; 
         &lt;param name=&quot;schemaObjectPrefix&quot; value=&quot;version_&quot; /&gt; 
      &lt;/PersistenceManager&gt;
&lt;/Versioning&gt;
</code></pre><p><strong>Using Deployit with <a href="http://www.oracle.com/us/products/database/index.html">Oracle</a></strong></p>
<pre><code>&lt;Workspace name=&quot;${wsp.name}&quot;&gt;
    &lt;FileSystem class=&quot;org.apache.jackrabbit.core.fs.local.LocalFileSystem&quot;&gt;
       &lt;param name=&quot;path&quot; value=&quot;${wsp.home}&quot; /&gt;
    &lt;/FileSystem&gt;

    &lt;PersistenceManager 
       class=&quot;org.apache.jackrabbit.core.persistence.bundle.OraclePersistenceManager&quot;&gt;
       &lt;param name=&quot;driver&quot; value=&quot;oracle.jdbc.driver.OracleDriver&quot;/&gt;
       &lt;param name=&quot;url&quot; value=&quot;jdbc:oracle:thin:@localhost:1521:orcl&quot;/&gt;
       &lt;param name=&quot;user&quot; value=&quot;deployit&quot; /&gt; 
       &lt;param name=&quot;password&quot; value=&quot;deployit&quot; /&gt;
       &lt;param name=&quot;databaseType&quot; value=&quot;oracle&quot; /&gt; 
       &lt;param name=&quot;schemaObjectPrefix&quot; value=&quot;${wsp.name}_&quot; /&gt; 
    &lt;/PersistenceManager&gt;

    &lt;SearchIndex class=&quot;org.apache.jackrabbit.core.query.lucene.SearchIndex&quot;&gt;
       &lt;param name=&quot;path&quot; value=&quot;${wsp.home}/index&quot; /&gt;
       &lt;param name=&quot;supportHighlighting&quot; value=&quot;true&quot; /&gt;
    &lt;/SearchIndex&gt;
&lt;/Workspace&gt;

&lt;Versioning rootPath=&quot;${rep.home}/version&quot;&gt;
    &lt;FileSystem class=&quot;org.apache.jackrabbit.core.fs.local.LocalFileSystem&quot;&gt;
       &lt;param name=&quot;path&quot; value=&quot;${rep.home}/version&quot; /&gt;
    &lt;/FileSystem&gt;

    &lt;PersistenceManager 
       class=&quot;org.apache.jackrabbit.core.persistence.bundle.OraclePersistenceManager&quot;&gt;
       &lt;param name=&quot;driver&quot; value=&quot;oracle.jdbc.driver.OracleDriver&quot;/&gt;
       &lt;param name=&quot;url&quot; value=&quot;jdbc:oracle:thin:@localhost:1521:orcl&quot;/&gt;
       &lt;param name=&quot;user&quot; value=&quot;deployit&quot; /&gt; 
       &lt;param name=&quot;password&quot; value=&quot;deployit&quot; /&gt;
       &lt;param name=&quot;databaseType&quot; value=&quot;oracle&quot; /&gt; 
       &lt;param name=&quot;schemaObjectPrefix&quot; value=&quot;version_&quot; /&gt; 
    &lt;/PersistenceManager&gt;
&lt;/Versioning&gt;
</code></pre><p>If you use the TNSNames Alias syntax to connect to Oracle, you may need to inform the driver where to find the TNSNAMES file. See the Oracle documentation for more details.</p><p><strong>Clustering Jackrabbit</strong></p><p>It is also possible to run Deployit server with its repository shared with other Deployit server instances. For this to happen, the jackrabbit JCR must be configured to run in a <a href="http://wiki.apache.org/jackrabbit/Clustering#Overview">clustered mode</a>. This needs a cluster configuration to be present in the jackrabbit-repository.xml file.</p><p>The following XML snippet shows a sample clustering configuration for a JCR using Oracle as its repository.</p>
<pre><code>&lt;Cluster id=&quot;101&quot; syncDelay=&quot;2000&quot;&gt;
    &lt;Journal class=&quot;org.apache.jackrabbit.core.journal.OracleDatabaseJournal&quot;&gt;
       &lt;param name=&quot;revision&quot; value=&quot;${rep.home}/revision&quot; /&gt;
       &lt;param name=&quot;driver&quot; value=&quot;oracle.jdbc.driver.OracleDriver&quot; /&gt;
       &lt;param name=&quot;url&quot; value=&quot;jdbc:oracle:thin:@localhost:1521:orcl&quot; /&gt;
       &lt;param name=&quot;user&quot; value=&quot;deployit&quot; /&gt;
       &lt;param name=&quot;password&quot; value=&quot;deployit&quot; /&gt;
       &lt;param name=&quot;schemaObjectPrefix&quot; value=&quot;JOURNAL_&quot; /&gt;
    &lt;/Journal&gt;
&lt;/Cluster&gt;
</code></pre><p>Note that each jackrabbit cluster node should have a unique value for <code>id</code>. For more information on JCR clustering, or ways to configure clustering using other databases, please refer to the jackrabbit <a href="http://wiki.apache.org/jackrabbit/Clustering#Overview">clustering documnentation</a>.</p><h2>Installing Plugins</h2><p>Deployit Server supports various plugins that add functionality to the system. When it starts, the Deployit server scans the <code>plugins</code> directory and loads all plugins it finds. The additional functionality they provide is immediately available. Any plugins added or removed when Deployit server is running will not take effect until the server is restarted.</p><p><strong>Installing a Plugin</strong></p><p>To install a new plugin, stop the Deployit server and copy the plugin JAR archive into the <code>plugins</code> directory, then restart the Deployit server.</p><p><strong>Uninstalling a Plugin</strong></p><p>To uninstall a plugin, stop the Deployit server and remove the plugin JAR archive from the <code>plugins</code> directory, then restart the Deployit server.</p><h2>Configuring Logging</h2><p>Out of the box, Deployit server writes informational, warning and error log messages to standard output as well as <code>log/deployit.log</code> when running. It is possible to change this behavior to write log output to a file or to log output from a specific source. </p><p>Deployit uses the Logback logging framework for it's logging. To change it's behavior, edit the file <code>logback.xml</code> in the <code>conf</code> directory of the Deployit server installation directory.</p><p>The following is an example <code>logback.xml</code> file:</p>
<pre><code>&lt;configuration&gt;
    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
       &lt;!-- encoders are assigned the type
          ch.qos.logback.classic.encoder.PatternLayoutEncoder by default --&gt;
       &lt;encoder&gt;
         &lt;pattern&gt;
          %d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n
         &lt;/pattern&gt;
       &lt;/encoder&gt;
    &lt;/appender&gt;

    &lt;!-- Create a file appender that writes log messages to a file --&gt;
    &lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;
        &lt;layout class=&quot;ch.qos.logback.classic.PatternLayout&quot;&gt;
            &lt;pattern&gt;%-4relative [%thread] %-5level %class - %msg%n&lt;/pattern&gt;
        &lt;/layout&gt;
        &lt;File&gt;log/my.log&lt;/File&gt;
    &lt;/appender&gt;

    &lt;!-- Set logging of classes in com.xebialabs to DEBUG level --&gt;
    &lt;logger name=&quot;com.xebialabs&quot; level=&quot;debug&quot;/&gt;

    &lt;!-- Set logging of class HttpClient to DEBUG level --&gt;
    &lt;logger name=&quot;HttpClient&quot; level=&quot;debug&quot;/&gt;

    &lt;!-- Set the logging of all other classes to INFO --&gt;
    &lt;root level=&quot;info&quot;&gt;
       &lt;!-- Write logging to STDOUT and FILE appenders --&gt;
       &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;
       &lt;appender-ref ref=&quot;FILE&quot; /&gt;
    &lt;/root&gt;

&lt;/configuration&gt;
</code></pre><p>For more information see the <a href="http://logback.qos.ch/">Logback website</a>.</p><h1>Setting up Deployit</h1><p>This section describes how to setup Deployit server in your environment.</p><p>Deployit must be setup for your environment before it can be used to execute deployments. This entails the following steps:</p>
<ol>
  <li><strong>Start the Deployit server</strong>.</li>
  <li><strong>Discover your middleware</strong>. Deployit can inspect your environment and automatically create CIs for your middleware. Alternatively, you can use a bulk-import to import your middleware or create them by hand using the Deployit GUI.</li>
  <li><strong>Add the discovered middleware to an environment</strong>. CIs must be grouped in an environment to use them for deployment.</li>
</ol><p>Setup of Deployit is performed using the Deployit Command Line Interface (CLI). For more information about the CLI, see the <strong>Deployit Command Line Interface (CLI) Manual</strong>.</p><h2>Starting and Stopping</h2><p><strong>Starting the Server</strong></p><p>Open a terminal window and change to the DEPLOYIT_SERVER_HOME directory. Start the Deployit server with the command:</p>
<pre><code>bin/server.sh
</code></pre><p>on Unix and</p>
<pre><code>bin/server.cmd
</code></pre><p>on Windows.</p><p>By starting the server with the <code>-h</code> flag, a message is printed that shows the possible options it supports:</p>
<pre><code>server.sh arguments...
    -reinitialize : Reinitialize the repository, only useful with -setup
    -setup        : (Re-)run the setup for Deployit
</code></pre><p>The command line options are:</p>
<ul>
  <li><code>-reinitialize</code> -- tells Deployit to reinitialize the repository. Used only in conjunction with <code>-setup</code>. <strong>N.B.</strong> This flag only works if Deployit is running on the filesystem repository, not when you've configured Deployit to run against a database.</li>
  <li><code>-setup</code> -- runs the Deployit Setup Wizard.</li>
  <li><code>-test-mode</code> -- enables Deployit server test-mode. When test-mode is enabled, WebDAV access to the JCR repository is installed. The repository can be accessed using a URL like <code>http://localhost:4516/repository/default/</code>.</li>
</ul><p><strong>Server Options</strong></p><p>Any options you want to give the Deployit Server when it starts can be specified in the <em>DEPLOYIT_SERVER_OPTS</em> environment variable.</p><p><strong>Starting Deployit in the Background</strong></p><p>By running the <code>server.sh</code> or <code>server.cmd</code> command, the Deployit server is started in the foreground. To run the server as a background process, use:</p>
<pre><code>nohup bin/server.sh &amp;
</code></pre><p>on Unix or run Deployit as a <a href="http://support.microsoft.com/kb/137890">service on Windows</a>.</p><p><strong>Java Properties</strong></p><p>Deployit server also responds to certain Java properties that influence it's behavior. These properties may be set in the environment (e.g. by executing <code>export jetty.host=127.0.0.1</code> in the terminal used to start the server) or by passing them to Java on the command line (for instance, by adding the flag <code>-Djetty.host=127.0.0.1</code> to the command that starts the server). The following option is supported:</p>
<ul>
  <li><code>jetty.host</code> -- sets the host that Deployit's embedded HTTP server binds to. Default value is <code>localhost</code>.</li>
</ul><p><strong>Stopping the Server</strong></p><p>It is possible to stop the Deployit server using a REST API call. The following is an example of a command to generate such a call (replace <code>admin:admin</code> with your own credentials):</p>
<pre><code>curl -X POST --basic -u admin:admin 
    http://admin:admin@localhost:4516/deployit/server/shutdown
</code></pre><p>This requires the external <code>curl</code> command, available for both Unix and Windows.</p><h2>Editing CIs</h2><p>The CIs in the Deployit repository can also be edited, either using the command line interface (CLI) or graphical user interface (GUI). See the respective manuals for more details.</p><h1>Maintaining Deployit</h1><p>This section describes how to maintain the Deployit server in your environment.</p><h2>Creating Backups</h2><p>To create a backup of Deployit, several components may need to be backed up depending on your configuration:</p>
<ul>
  <li><strong>JCR repository</strong>.
  <ul>
    <li>Built-in repository: Create a backup of the built-in JCR repository by backing up the files in the repository directory.</li>
    <li>Database repository: Create a backup of the database using the tools provdided by your vendor.</li>
  </ul></li>
  <li><strong>Configuration</strong>. Create a backup of the Deployit configuration by backing up the files in the <code>conf</code> directory in the installation directory.</li>
  <li><strong>Customization</strong>. Create a backup of the Deployit customizations by backing up the files in the <code>ext</code> and <code>plugins</code> directory in the installation directory.</li>
</ul><p><strong>Note:</strong> Deployit <strong>must not</strong> be running when you are making a backup. Schedule backups outside planned deployment hours to ensure the server is not being used.</p><h2>Restoring Backups</h2><p>To restore a backup of Deployit, restore one of the following components:</p>
<ul>
  <li><strong>JCR repository</strong>.
  <ul>
    <li>Built-in repository: Remove the repository directory and replace it with the backup.</li>
    <li>Database repository: Restore a backup of the database using the tools provdided by your vendor.</li>
  </ul></li>
  <li><strong>Configuration</strong>. Remove the <code>conf</code> directory in the DEPLOYIT_SERVER_HOME directory and replace it with the backup.</li>
  <li><strong>Customization</strong>. Remove the <code>ext</code> and <code>plugins</code> directories in the DEPLOYIT_SERVER_HOME directory and replace them with the backups.</li>
</ul><p><strong>Note:</strong> Deployit <strong>must not</strong> be running when you are restoring a backup.</p></body></html>